---
/**
 * Videos Page
 *
 * Displays the complete video gallery using the VideoGallery component.
 * Loads videos from the 'videos' content collection and transforms them
 * for the gallery display.
 *
 * Features:
 * - Automatic sorting by publish date (newest first)
 * - Responsive grid layout (3 columns → 2 → 1)
 * - SEO optimized with meta tags
 * - Static HTML with interactive gallery (client:load)
 * - Mobile-optimized spacing and typography
 * - Dark mode support via semantic tokens
 * - Accessible with proper heading hierarchy
 *
 * Responsive breakpoints:
 * - Mobile (<768px): Single column, compact spacing
 * - Tablet (768-1024px): 2 columns, balanced layout
 * - Desktop (>1024px): 3 columns, spacious grid
 */

import { getCollection } from 'astro:content';
import Layout from '@/layouts/Layout.astro';
import { VideoGallery } from '@/components/media/VideoGallery';

// Fetch all videos from content collection
const videos = await getCollection('videos');

// Transform video data for VideoGallery component
const videoData = videos.map(v => ({
  title: v.data.title,
  description: v.data.description,
  thumbnail: v.data.thumbnail,
  duration: v.data.duration,
  slug: v.slug,
  author: v.data.author,
  publishedAt: v.data.publishedAt,
  youtubeId: v.data.youtubeId, // Auto-generate thumbnail from YouTube
}));

// Page metadata
const pageTitle = 'Videos - ONE Platform';
const pageDescription = 'Explore our collection of video tutorials, guides, and insights about blockchain technology, Sui, Web3, and the ONE Platform.';
---

<Layout
  title={pageTitle}
  description={pageDescription}
  sidebarInitialCollapsed={false}
>
  <!-- Page Container - responsive padding and max-width -->
  <div class="container mx-auto py-6 sm:py-8 lg:py-12 px-4 sm:px-6 lg:px-8 max-w-7xl">
    <!-- Page Header - responsive typography -->
    <header class="mb-6 sm:mb-8 lg:mb-10 space-y-3 sm:space-y-4">
      <h1 class="text-3xl sm:text-4xl lg:text-5xl font-bold tracking-tight">
        Videos
      </h1>
      <p class="text-base sm:text-lg text-muted-foreground max-w-2xl leading-relaxed">
        Discover in-depth video content covering blockchain development,
        Sui ecosystem updates, market analysis, and platform tutorials.
      </p>
    </header>

    <!-- Stats Banner - responsive sizing and spacing -->
    {videoData.length > 0 && (
      <div class="mb-6 sm:mb-8 p-3 sm:p-4 bg-muted/50 rounded-lg border">
        <p class="text-sm sm:text-base text-muted-foreground">
          <span class="font-semibold text-foreground">{videoData.length}</span>
          {videoData.length === 1 ? ' video' : ' videos'} available
        </p>
      </div>
    )}

    <!-- Video Gallery Component - static rendering, no client directive needed -->
    <VideoGallery
      videos={videoData}
    />

    <!-- Back to top button - touch-friendly on mobile -->
    {videoData.length > 6 && (
      <div class="mt-8 sm:mt-12 flex justify-center">
        <button
          onclick="window.scrollTo({ top: 0, behavior: 'smooth' })"
          class="px-4 py-2 sm:px-6 sm:py-3 rounded-lg bg-muted hover:bg-muted/80 text-sm sm:text-base font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 touch-manipulation"
          aria-label="Scroll to top"
        >
          Back to top
        </button>
      </div>
    )}
  </div>
</Layout>
