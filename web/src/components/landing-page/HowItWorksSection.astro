---
import { Card, CardHeader, CardTitle, CardDescription } from "@/components/ui/card";
import { Badge } from "@/components/ui/badge";
import { Zap } from "lucide-react";
import type { HowItWorksSectionProps } from "@/types/landing-page";

interface Props extends Omit<HowItWorksSectionProps, "branding"> {
  branding?: any;
}

const { section, branding } = Astro.props;

const brandingStyle = branding
  ? `--primary: ${branding.primaryColor || "#3b82f6"};`
  : "";
---

<section class={`px-4 py-20 sm:px-6 sm:py-24 md:px-8 md:py-32 border-y bg-muted/50 ${section.customClass || ""}`} style={brandingStyle}>
  <div class="mx-auto max-w-full sm:max-w-6xl">
    <!-- Section Header -->
    {section.title && (
      <div class="mb-20 space-y-4 text-center">
        <Badge variant="outline" className="mb-2 inline-flex items-center gap-2">
          <Zap className="h-4 w-4" />
          Process
        </Badge>
        <h2 class="text-4xl font-bold leading-tight tracking-tight sm:text-5xl">
          {section.title}
        </h2>
      </div>
    )}

    <!-- Steps Grid -->
    <div class="grid gap-8 md:grid-cols-2 lg:grid-cols-4">
      {section.steps.map((step, index) => (
        <div class="relative">
          <!-- Step Card -->
          <Card className="group border-border/50 bg-card/50 backdrop-blur transition-all hover:scale-[1.02] hover:border-primary/20 hover:bg-card hover:shadow-lg hover:shadow-primary/5 h-full">
            <CardHeader className="space-y-4">
              <!-- Step Number Circle -->
              <div class="flex h-12 w-12 items-center justify-center rounded-full bg-primary/10 text-2xl font-bold text-primary">
                {(step.number || index + 1).toString().padStart(2, "0")}
              </div>

              <!-- Step Title and Description -->
              <CardTitle className="text-xl">{step.title}</CardTitle>
              <CardDescription className="leading-relaxed text-base">
                {step.description}
              </CardDescription>

              <!-- Optional Step Image -->
              {step.image && (
                <div class="mt-4 aspect-video overflow-hidden rounded-lg bg-muted">
                  <img
                    src={step.image}
                    alt={step.title}
                    class="h-full w-full object-cover"
                  />
                </div>
              )}
            </CardHeader>
          </Card>

          <!-- Connection Arrow (hidden on last step) -->
          {index < section.steps.length - 1 && (
            <div class="hidden lg:block absolute top-1/2 -right-4 w-8 h-0.5 bg-gradient-to-r from-primary to-transparent transform -translate-y-1/2"></div>
          )}
        </div>
      ))}
    </div>

    <!-- Timeline Summary (Optional) -->
    {section.steps.length > 0 && (
      <div class="mt-16 rounded-lg border border-primary/20 bg-primary/5 p-8 text-center">
        <p class="text-lg font-semibold text-foreground">
          Complete in {section.steps.length} simple steps
        </p>
        <p class="mt-2 text-muted-foreground">
          Each step is designed to be straightforward and fast
        </p>
      </div>
    )}
  </div>
</section>

<style define:vars={{ brandingStyle }}>
  section {
    --primary: var(--primary, #3b82f6);
  }
</style>
